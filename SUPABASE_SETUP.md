# ===========================================
# Supabase Migration Guide / –†—ä–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∑–∞ –º–∏–≥—Ä–∞—Ü–∏—è
# ===========================================

## üöÄ –°—Ç—ä–ø–∫–∏ –∑–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ Supabase

### 1. –°—ä–∑–¥–∞–π Supabase –ø—Ä–æ–µ–∫—Ç

1. –û—Ç–∏–¥–∏ –Ω–∞ https://supabase.com –∏ –≤–ª–µ–∑ –≤ –∞–∫–∞—É–Ω—Ç–∞ —Å–∏
2. –ö–ª–∏–∫–Ω–∏ "New Project"
3. –ò–∑–±–µ—Ä–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏ –≤—ä–≤–µ–¥–∏ –∏–º–µ –Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞
4. –ò–∑–±–µ—Ä–∏ —Ä–µ–≥–∏–æ–Ω (–ø—Ä–µ–ø–æ—Ä—ä—á–∏—Ç–µ–ª–Ω–æ: EU –∑–∞ –ø–æ-–±—ä—Ä–∑–∞ –≤—Ä—ä–∑–∫–∞)
5. –ó–∞–¥–∞–π –ø–∞—Ä–æ–ª–∞ –∑–∞ –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏ (–∑–∞–ø–∞–∑–∏ —è!)
6. –ö–ª–∏–∫–Ω–∏ "Create new project" –∏ –∏–∑—á–∞–∫–∞–π 2-3 –º–∏–Ω—É—Ç–∏

### 2. –°—ä–∑–¥–∞–π —Ç–∞–±–ª–∏—Ü–∏—Ç–µ –≤ –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏

1. –í Supabase Dashboard –æ—Ç–∏–¥–∏ –Ω–∞ **SQL Editor** (–ª—è–≤–æ –º–µ–Ω—é)
2. –ö–ª–∏–∫–Ω–∏ **New Query**
3. –ö–æ–ø–∏—Ä–∞–π –¶–ï–õ–ò–Ø –∫–æ–¥ –æ—Ç —Ñ–∞–π–ª–∞ `supabase-schema.sql`
4. –ö–ª–∏–∫–Ω–∏ **Run** (–∏–ª–∏ Ctrl+Enter)
5. –¢—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—à "Success. No rows returned" - —Ç–æ–≤–∞ –µ –û–ö!

### 3. –í–∑–µ–º–∏ API –∫–ª—é—á–æ–≤–µ—Ç–µ

1. –û—Ç–∏–¥–∏ –Ω–∞ **Project Settings** (–∏–∫–æ–Ω–∫–∞ –∑—ä–±–Ω–æ –∫–æ–ª–µ–ª–æ –¥–æ–ª—É –≤–ª—è–≤–æ)
2. –ö–ª–∏–∫–Ω–∏ –Ω–∞ **API** –≤ –º–µ–Ω—é—Ç–æ
3. –ö–æ–ø–∏—Ä–∞–π —Å–ª–µ–¥–Ω–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏:
   - **Project URL** ‚Üí `SUPABASE_URL`
   - **service_role key** (–ø–æ–¥ "Project API keys") ‚Üí `SUPABASE_SERVICE_ROLE_KEY`
   
   ‚ö†Ô∏è **–í–ê–ñ–ù–û**: –ò–∑–ø–æ–ª–∑–≤–∞–π `service_role` key, –ù–ï `anon` key!
   Service role key –∏–º–∞ –ø—ä–ª–µ–Ω –¥–æ—Å—Ç—ä–ø –¥–æ –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏.

### 4. –ù–∞—Å—Ç—Ä–æ–π .env —Ñ–∞–π–ª–∞

–°—ä–∑–¥–∞–π `.env` —Ñ–∞–π–ª –≤ –≥–ª–∞–≤–Ω–∞—Ç–∞ –ø–∞–ø–∫–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞:

```env
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
JWT_SECRET=—Ç–≤–æ—è—Ç-—Å—É–ø–µ—Ä-—Ç–∞–µ–Ω-–∫–ª—é—á
RESEND_API_KEY=re_—Ç–≤–æ—è_api_key
PORT=5000
```

### 5. –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏—Ç–µ

```bash
npm install
```

### 6. –°—Ç–∞—Ä—Ç–∏—Ä–∞–π —Å—ä—Ä–≤—ä—Ä–∞

```bash
npm start
```

–¢—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—à:
```
‚úÖ Connected to Supabase database
üîî Reminder service starting...
‚úÖ Reminder service started successfully
üöÄ Server running on port 5000
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ —Ç–∞–±–ª–∏—Ü–∏—Ç–µ

### users
| –ö–æ–ª–æ–Ω–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----|----------|
| id | SERIAL | –ü—ä—Ä–≤–∏—á–µ–Ω –∫–ª—é—á |
| name | VARCHAR(255) | –ò–º–µ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è |
| email | VARCHAR(255) | Email (—É–Ω–∏–∫–∞–ª–µ–Ω) |
| password | VARCHAR(255) | –•–µ—à–∏—Ä–∞–Ω–∞ –ø–∞—Ä–æ–ª–∞ |
| reminder_days | INTEGER | –î–Ω–∏ –ø—Ä–µ–¥–∏ –Ω–∞–ø–æ–º–Ω—è–Ω–µ (–ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ 30) |
| created_at | TIMESTAMP | –î–∞—Ç–∞ –Ω–∞ —Å—ä–∑–¥–∞–≤–∞–Ω–µ |
| updated_at | TIMESTAMP | –î–∞—Ç–∞ –Ω–∞ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ |

### cars
| –ö–æ–ª–æ–Ω–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----|----------|
| id | SERIAL | –ü—ä—Ä–≤–∏—á–µ–Ω –∫–ª—é—á |
| user_id | INTEGER | FK –∫—ä–º users |
| brand | VARCHAR(255) | –ú–∞—Ä–∫–∞ |
| model | VARCHAR(255) | –ú–æ–¥–µ–ª |
| year | INTEGER | –ì–æ–¥–∏–Ω–∞ |
| license_plate | VARCHAR(50) | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–µ–Ω –Ω–æ–º–µ—Ä |
| vin | VARCHAR(50) | VIN –Ω–æ–º–µ—Ä |
| engine_type | VARCHAR(100) | –¢–∏–ø –¥–≤–∏–≥–∞—Ç–µ–ª |
| horsepower | INTEGER | –ö–æ–Ω—Å–∫–∏ —Å–∏–ª–∏ |
| transmission | VARCHAR(50) | –°–∫–æ—Ä–æ—Å—Ç–Ω–∞ –∫—É—Ç–∏—è |
| euro_standard | VARCHAR(20) | –ï–≤—Ä–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç |
| mileage | INTEGER | –ö–∏–ª–æ–º–µ—Ç—Ä–∞–∂ |
| fuel_type | VARCHAR(50) | –¢–∏–ø –≥–æ—Ä–∏–≤–æ |
| tire_* | - | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –≥—É–º–∏—Ç–µ |

### services
| –ö–æ–ª–æ–Ω–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----|----------|
| id | SERIAL | –ü—ä—Ä–≤–∏—á–µ–Ω –∫–ª—é—á |
| car_id | INTEGER | FK –∫—ä–º cars |
| user_id | INTEGER | FK –∫—ä–º users |
| service_type | VARCHAR(100) | –¢–∏–ø —É—Å–ª—É–≥–∞ |
| expiry_date | TIMESTAMP | –î–∞—Ç–∞ –Ω–∞ –∏–∑—Ç–∏—á–∞–Ω–µ |
| cost | DECIMAL(10,2) | –¶–µ–Ω–∞ |
| notes | TEXT | –ë–µ–ª–µ–∂–∫–∏ |
| liters | DECIMAL(10,2) | –õ–∏—Ç—Ä–∏ (–∑–∞ –≥–æ—Ä–∏–≤–æ) |
| price_per_liter | DECIMAL(10,2) | –¶–µ–Ω–∞ –Ω–∞ –ª–∏—Ç—ä—Ä |
| fuel_type | VARCHAR(50) | –¢–∏–ø –≥–æ—Ä–∏–≤–æ |
| reminder_sent | BOOLEAN | –ò–∑–ø—Ä–∞—Ç–µ–Ω–æ –ª–∏ –µ –Ω–∞–ø–æ–º–Ω—è–Ω–µ |

### admins
| –ö–æ–ª–æ–Ω–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----|----------|
| id | SERIAL | –ü—ä—Ä–≤–∏—á–µ–Ω –∫–ª—é—á |
| username | VARCHAR(255) | –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ |
| password | VARCHAR(255) | –•–µ—à–∏—Ä–∞–Ω–∞ –ø–∞—Ä–æ–ª–∞ |
| name | VARCHAR(255) | –ò–º–µ |
| last_login | TIMESTAMP | –ü–æ—Å–ª–µ–¥–µ–Ω –≤—Ö–æ–¥ |

---

## üîí –°–∏–≥—É—Ä–Ω–æ—Å—Ç

- **Service Role Key**: –ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –°–ê–ú–û –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞, –ù–ò–ö–û–ì–ê –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏ –∫–æ–¥!
- Row Level Security (RLS) –µ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω, –Ω–æ –ø–æ–ª–∏—Ç–∏–∫–∏—Ç–µ –Ω–µ —Å–µ –ø—Ä–∏–ª–∞–≥–∞—Ç –ø—Ä–∏ service_role
- –ü–∞—Ä–æ–ª–∏—Ç–µ —Å–µ —Ö–µ—à–∏—Ä–∞—Ç —Å bcrypt –ø—Ä–µ–¥–∏ –∑–∞–ø–∏—Å

---

## üÜò –û—Ç—Å—Ç—Ä–∞–Ω—è–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–±–ª–µ–º–∏

### "Missing Supabase environment variables!"
- –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ `.env` —Ñ–∞–π–ª—ä—Ç —Å—ä—â–µ—Å—Ç–≤—É–≤–∞
- –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ `SUPABASE_URL` –∏ `SUPABASE_SERVICE_ROLE_KEY` —Å–∞ –∑–∞–¥–∞–¥–µ–Ω–∏

### "Database connection error"
- –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ URL-—ä—Ç –µ –ø—Ä–∞–≤–∏–ª–µ–Ω
- –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ —Ç–∞–±–ª–∏—Ü–∏—Ç–µ —Å–∞ —Å—ä–∑–¥–∞–¥–µ–Ω–∏ (–∏–∑–ø—ä–ª–Ω–∏ SQL schema)
- –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ service_role key –µ –ø—Ä–∞–≤–∏–ª–µ–Ω

### "relation 'users' does not exist"
- –ò–∑–ø—ä–ª–Ω–∏ SQL schema –≤ Supabase SQL Editor

---

## üì± –î–µ–ø–ª–æ–π –Ω–∞ Supabase Edge Functions (–û–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)

–ê–∫–æ –∏—Å–∫–∞—à –¥–∞ –ø—Ä–µ–º–µ—Å—Ç–∏—à –∏ backend –ª–æ–≥–∏–∫–∞—Ç–∞ –≤ Supabase:

1. –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–π Supabase CLI
2. –°—ä–∑–¥–∞–π Edge Functions –∑–∞ –≤—Å–µ–∫–∏ route
3. –î–µ–ø–ª–æ–π–Ω–∏ —Å `supabase functions deploy`

–¢–æ–≤–∞ –µ –ø–æ-–Ω–∞–ø—Ä–µ–¥–Ω–∞–ª–∞ —Ç–µ–º–∞ - —Ç–µ–∫—É—â–∞—Ç–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∏ –ø–µ—Ä—Ñ–µ–∫—Ç–Ω–æ —Å Node.js —Å—ä—Ä–≤—ä—Ä + Supabase –±–∞–∑–∞ –¥–∞–Ω–Ω–∏.
